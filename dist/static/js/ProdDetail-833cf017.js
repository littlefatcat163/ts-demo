var e=Object.defineProperty,t=Object.defineProperties,u=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,u,a)=>u in t?e(t,u,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[u]=a;"undefined"!=typeof require&&require;import{S as l,F as c,g as i,E as s,B as V,e as d,T as p,A as f,C as m,P as h,h as g,w,u as N,i as y,j as v,p as b}from"./index-4e14797f.js";import{W as x,L as k,b as C}from"./index-ab0b2098.js";import{u as E}from"./useUpdateTitle-e49761b3.js";import"./vendor-fab6682b.js";const B="IWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2NvbnN0IGU9TnVtYmVyLnBhcnNlSW50KCIxODAwMDAwIik7bGV0IHQ7ZnVuY3Rpb24gbihuKXt0fHwodD1uZXcgTWFwKTtjb25zdHttb2RlOmEsa2V5Om8sY3JlYXRlVGltZTpyLGRhdGE6c309bjtpZigiZGVsZXRlIj09PWEpcmV0dXJuIHZvaWQgdC5kZWxldGUobyk7aWYoInB1dCI9PT1hKXJldHVybiB2b2lkIHQuc2V0KG8se2NyZWF0ZVRpbWU6cixkYXRhOnN9KTtjb25zdCBpPXQuZ2V0KG8pO2lmKG51bGwhPWkmJmZ1bmN0aW9uKGUsdCl7aWYoMD09PWUpcmV0dXJuITE7Y29uc3Qgbj1EYXRlLm5vdygpLWU7cmV0dXJuIG48PTB8fG4+PXR9KGkuY3JlYXRlVGltZSxlKSlyZXR1cm4gdC5kZWxldGUobyksdm9pZCBwb3N0TWVzc2FnZShudWxsKTtwb3N0TWVzc2FnZShudWxsPT1pP3ZvaWQgMDppLmRhdGEpfW9ubWVzc2FnZT1lPT57bihlLmRhdGEpfX0oKTsK",P="undefined"!=typeof window&&window.Blob&&new Blob([atob(B)],{type:"text/javascript;charset=utf-8"});function R(){const e=P&&(window.URL||window.webkitURL).createObjectURL(P);try{return e?new Worker(e):new Worker("data:application/javascript;base64,"+B,{type:"module"})}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}const T=[];let S,W;function j(){null==W&&(W=T.shift(),null!=W&&S.postMessage(W.clientCache))}function _(e,t){var u;u={cb:e,clientCache:{key:t,mode:"get"}},S||(S=new R,S.onmessage=e=>{W.cb(e.data),W=void 0,j()}),T.push(u),j()}const Z=axios.create({baseURL:"/x2s",timeout:12e3,headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}});Z.interceptors.request.use((e=>{if(e.cache&&/get/i.test(e.method)){const t=axios.CancelToken.source();return e.cancelToken=t.token,new Promise((u=>{_((a=>{null!=a&&t.cancel(JSON.stringify(a)),u(e)}),e.url)}))}return e})),Z.interceptors.response.use((e=>{const{status:t,config:u}=e;if(204===t)throw new Error("none");return u.cache&&/get/i.test(u.method)&&function(e,t,u=Date.now()){S.postMessage({key:e,data:t,createTime:u,mode:"put"})}(u.url,e.data),e}),(e=>{if(axios.isCancel(e)){const t={status:307,statusText:"cache",data:JSON.parse(e.message),headers:null,config:{}};return Promise.resolve(t)}return Promise.reject(e)}));const I={product:{name:"圣凯特红葡萄酒",remark:"法国罗纳河谷15度村庄级AOC进口原装红酒",price:198,id:"610a3ca656ac45df22dab7f0"},specifications:[{name:"750ml/支",price:198,inventory:100,id:"61245eada579fd79d0a4fa4f"},{name:"6支/箱",price:978,inventory:100,id:"61245eada579fd79d0a4fa50"}],infos:[]};var O={list:e=>Z.post("/product/list",e),findProduct:e=>(console.log(e),new Promise((e=>{setTimeout((()=>{e({data:I})}),1e3)})))};function G(){const e=Vue.reactive({loading:!0,product:null,specifications:[],infos:[],patterns:[],errMsg:null});return{qryResult:e,queryDetail:async t=>{e.loading=!0,e.errMsg=null;try{const{data:{product:u,specifications:a,infos:n=[],patterns:o=[]}}=await O.findProduct(t);Object.assign(e,{product:u,specifications:a,infos:n,patterns:o})}catch(u){console.log(u),e.errMsg="errMsg"}finally{e.loading=!1}}}}Vue.pushScopeId("data-v-48fd6469");const D={class:"prod-spec-skeleton"},L={class:"aside-item"},U={class:"aside-item"},K={class:"aside-item"},X=Vue.createTextVNode("重新加载"),M={key:1},Y=Vue.createElementVNode("header",null,"规格",-1),q={class:"aside-item"},z=Vue.createElementVNode("header",null,"数量",-1),J={class:"aside-item"},F=Vue.createTextVNode("确定");Vue.popScopeId();var H=Vue.defineComponent({props:{id:{type:String,required:!0}},emits:["confirm"],setup(e,{emit:t}){const u=e,a=Vue.ref(1),{qryResult:n,queryDetail:o}=G(),r=Vue.ref(0),g=Vue.computed((()=>n.specifications[r.value])),w=Vue.computed((()=>g.value.price*a.value)),N=()=>{const e={product:Vue.toRaw(n.product),specification:Vue.toRaw(g.value),buyNum:a.value,cost:w.value};t("confirm",e)},y=e=>{const t=e.target;/span/i.test(t.tagName)&&(r.value=Number.parseInt(t.dataset.index))};Vue.onMounted((()=>{o(u.id)}));const v=()=>{o(u.id)};return(e,t)=>(Vue.openBlock(),Vue.createBlock(Vue.unref(l),{loading:Vue.unref(n).loading},{template:Vue.withCtx((()=>[Vue.createElementVNode("section",D,[Vue.createVNode(Vue.unref(c),{tag:"header",class:"header"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(i),{tag:"img",style:{width:"96px",height:"96px"}}),Vue.createElementVNode("div",null,[Vue.createVNode(Vue.unref(i),{tag:"h2",style:{width:"88px"}}),Vue.createVNode(Vue.unref(i),{tag:"p",style:{width:"128px"}})])])),_:1}),Vue.createElementVNode("aside",L,[Vue.createVNode(Vue.unref(i),{tag:"header",style:{width:"48px"}}),Vue.createVNode(Vue.unref(i),{style:{width:"128px",height:"24px"}})]),Vue.createElementVNode("aside",U,[Vue.createVNode(Vue.unref(i),{tag:"header",style:{width:"48px"}}),Vue.createVNode(Vue.unref(i),{tag:"span",class:"tag tag-normal",style:{width:"128px"}})]),Vue.createElementVNode("div",K,[Vue.createVNode(Vue.unref(i),{tag:"button",class:"btn-primary btn-normal btn-block"})])])])),default:Vue.withCtx((()=>[Vue.unref(n).errMsg?(Vue.openBlock(),Vue.createBlock(Vue.unref(s),{key:0},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(V),{type:"primary",onClick:Vue.withModifiers(v,["stop"])},{default:Vue.withCtx((()=>[X])),_:1},8,["onClick"])])),_:1})):(Vue.openBlock(),Vue.createElementBlock("article",M,[Vue.createVNode(Vue.unref(c),{tag:"header",class:"header"},{default:Vue.withCtx((()=>{var e,t;return[Vue.createVNode(Vue.unref(d),{width:"96px",alt:"product",asset:null==(e=Vue.unref(n).product)?void 0:e.id,assetPath:Vue.unref(g).id,assetSize:"mini"},null,8,["asset","assetPath"]),Vue.createElementVNode("div",null,[Vue.createElementVNode("h2",null,"¥ "+Vue.toDisplayString(Vue.unref(g).price),1),Vue.createElementVNode("p",null,Vue.toDisplayString(null==(t=Vue.unref(n).product)?void 0:t.name),1)])]})),_:1}),Vue.createElementVNode("aside",{class:"aside-item",onClick:y},[Y,(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(n).specifications,((e,t)=>(Vue.openBlock(),Vue.createBlock(Vue.unref(p),{key:e.id,type:t===r.value?"primary":"info","data-index":t,size:"small"},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(e.name),1)])),_:2},1032,["type","data-index"])))),128))]),Vue.createElementVNode("aside",q,[z,Vue.createVNode(Vue.unref(f),{value:a.value,"onUpdate:value":t[0]||(t[0]=e=>a.value=e),theme:null==Vue.unref(n).patterns?"default":"white"},null,8,["value","theme"]),Vue.createVNode(Vue.unref(m),{offset:[30,-68],level:Vue.unref(w)>200?1:0},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(h),{size:"large",fee:Vue.unref(w)},null,8,["fee"])])),_:1},8,["level"])]),Vue.createElementVNode("div",J,[Vue.createVNode(Vue.unref(V),{block:"",type:"primary",onClick:N},{default:Vue.withCtx((()=>[F])),_:1})])]))])),_:1},8,["loading"]))}});H.__scopeId="data-v-48fd6469";const Q=Vue.defineComponent({name:"ChooseProductSpecificationPopup"});var A,$=w(Vue.defineComponent((A=((e,t)=>{for(var u in t||(t={}))n.call(t,u)&&r(e,u,t[u]);if(a)for(var u of a(t))o.call(t,u)&&r(e,u,t[u]);return e})({},Q),t(A,u({setup:function(e,{expose:t}){const{openPopup:u,closePopup:a,show:n}=function(){const e=Vue.ref(!1);let t,u;return{show:e,openPopup:(a,n)=>{t=a,u=n,e.value=!0},closePopup:(a=!0,n)=>{t&&u&&(e.value=!1,a?t(n):u(n),t=null,u=null)}}}(),o=Vue.ref(""),r=e=>{a(!0,e)},l=()=>{a(!1)};return t({chooseProductSpec:e=>(o.value=e,new Promise(((e,t)=>{u(e,t)})))}),(e,t)=>(Vue.openBlock(),Vue.createBlock(Vue.unref(g),{show:Vue.unref(n),"onUpdate:show":t[0]||(t[0]=e=>Vue.isRef(n)?n.value=e:null),onClose:l},{default:Vue.withCtx((()=>[Vue.createVNode(H,{id:o.value,onConfirm:r},null,8,["id"])])),_:1},8,["show"]))}})))));Vue.pushScopeId("data-v-3d463df1");const ee=Vue.createTextVNode("点击刷新"),te={class:"prod-detail"},ue={class:"prod-label"},ae={class:"prod-buy-btns"},ne={class:"prod-detail"},oe={class:"prod-label"},re={href:"#"},le={class:"prod-buy-btns"},ce=Vue.createTextVNode("加入购物袋"),ie=Vue.createTextVNode("立即购买"),se={class:"info-list"};Vue.popScopeId();var Ve=Vue.defineComponent({setup(e){E("");const t="xxxxxxxxxxxxx",{qryResult:u,queryDetail:a}=G(),n=Vue.ref(),o=Vue.ref();let r;const c=Vue.computed((()=>u.specifications[0])),p=e=>{let t=e.target;for(;!/li/i.test(t.tagName)&&null!=t;)t=t.parentElement;console.log(t.dataset.id)},f=()=>{n.value.chooseProductSpec(t).then((e=>{var t;r||(r=null==(t=o.value)?void 0:t.$el.getBoundingClientRect()),b(e,r)}))},{buyNow:m}=function(){const e=VueRouter.useRouter(),t=N();return{buyNow:u=>{t.buyNow(u),e.push("/shopping/bag/1")}}}(),h=()=>{n.value.chooseProductSpec(t).then((e=>{m(e)}))};Vue.onMounted((()=>{a(t)}));const g=()=>{a(t)};return(e,t)=>(Vue.openBlock(),Vue.createBlock(Vue.unref(x),null,{default:Vue.withCtx((()=>[Vue.unref(u).errMsg?(Vue.openBlock(),Vue.createBlock(Vue.unref(s),{key:0},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(V),{type:"primary",onClick:g},{default:Vue.withCtx((()=>[ee])),_:1})])),_:1})):(Vue.openBlock(),Vue.createBlock(Vue.unref(l),{key:1,loading:Vue.unref(u).loading},{template:Vue.withCtx((()=>[Vue.createElementVNode("div",te,[Vue.createVNode(Vue.unref(i),{tag:"h1"}),Vue.createVNode(Vue.unref(i),{tag:"p"}),Vue.createElementVNode("div",ue,[Vue.createVNode(Vue.unref(i)),Vue.createVNode(Vue.unref(i))]),Vue.createVNode(Vue.unref(i),{tag:"img",style:{width:"100vw",height:"100vw"}}),Vue.createElementVNode("div",ae,[Vue.createVNode(Vue.unref(i),{tag:"button"}),Vue.createVNode(Vue.unref(i),{tag:"button"})])])])),default:Vue.withCtx((()=>{var e,t;return[Vue.createElementVNode("article",ne,[Vue.createElementVNode("h1",null,Vue.toDisplayString(null==(e=Vue.unref(u).product)?void 0:e.name),1),Vue.createElementVNode("p",null,Vue.toDisplayString(null==(t=Vue.unref(u).product)?void 0:t.remark),1),Vue.createElementVNode("div",oe,[Vue.createElementVNode("span",null,Vue.toDisplayString(Vue.unref(c).name),1),Vue.createElementVNode("a",re,"¥ "+Vue.toDisplayString(Vue.unref(c).price),1)]),Vue.createVNode(Vue.unref(y),{ref:(e,t)=>{t.carouselRef=e,o.value=e}},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(u).specifications,(e=>(Vue.openBlock(),Vue.createBlock(Vue.unref(v),{key:e.id},{default:Vue.withCtx((()=>{var t;return[Vue.createVNode(Vue.unref(d),{asset:null==(t=Vue.unref(u).product)?void 0:t.id,assetPath:e.id,alt:"product-spec"},null,8,["asset","assetPath"])]})),_:2},1024)))),128))])),_:1},512),Vue.createElementVNode("div",le,[Vue.createVNode(Vue.unref(V),{onClick:f},{default:Vue.withCtx((()=>[ce])),_:1}),Vue.createVNode(Vue.unref(V),{onClick:h,type:"primary"},{default:Vue.withCtx((()=>[ie])),_:1})])]),Vue.createElementVNode("nav",se,[Vue.createVNode(Vue.unref(k),{onClick:p},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(u).infos,(e=>(Vue.openBlock(),Vue.createBlock(Vue.unref(C),{key:e.id,"data-id":e.id},{label:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(e.name),1)])),_:2},1032,["data-id"])))),128))])),_:1})])]})),_:1},8,["loading"])),Vue.createVNode(Vue.unref($),{ref:(e,t)=>{t.chooseproductSpecRef=e,n.value=e}},null,512)])),_:1}))}});Ve.__scopeId="data-v-3d463df1";export{Ve as default};
